<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Boot Agent</title>
    <link rel="stylesheet" href="assets/styles.css">
    <link rel="stylesheet" href="assets/highlight/styles/atom-one-dark.css">
    <script src="assets/highlight/highlight.min.js"></script>
    <script src="assets/script.js"></script> <!-- ! External script file -->
    <script>hljs.highlightAll();</script>
    <style>

        #sidebar-container {
            width: 25%; /* ! Sidebar max width set to 40% */
            max-width: 25%;
        }
        .content {
            flex-grow: 1; /* Ensures the content takes up the remaining space */
            max-width: 75%;
            padding-left: 20px; /* Adjust spacing as needed */
}
        table {
            max-width: 40%; /* ! Table max width set to 40% */
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid black;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="sidebar-container">
            <aside class="sidebar">
    <div class="logo">
        <a href="index.html">
            <img src="_images/logo.png" alt="Framework Logo">
        </a>
    </div>

    <h2>Framework</h2>
    <ul>
        <li>
            <a>About The Framework</a>
            <!-- ! Submenu -->
            <ul>
                <li><a href="general.html">General</a></li>
                <li><a href="tools.html">SP Tools</a></li>
                <li><a href="file-structure.html">File / Folder Structure</a></li>
<!--                <li><a href="file-order.html">File Import Order</a></li>-->
            </ul>
        </li>
        <li>
            <a>Framework Essentials</a>
            <!-- ! Submenu -->
            <ul>
                <li><a href="essentials.html#host-management">Host Management</a></li>
                <li><a href="essentials.html#global-functions">Global Functions</a></li>
                <li><a href="essentials.html#global-timers">Global Timers</a></li>
                <li><a href="essentials.html#ui-hosts_tlps">UI Hosts / TLPs</a></li>
                <li><a href="essentials.html#trace_print-tools">Trace / Print Tools</a></li>
                <li><a href="essentials.html#console-management">Console Management</a></li>
                <li><a href="essentials.html#building-ui-elements">Building UI Elements</a></li>
                <li><a href="essentials.html#access-ui-elements">Access UI Elements</a></li>
                <li><a href="essentials.html#me-set-tools">ME Set Tools</a></li>
                <li><a href="essentials.html#ui-element-set-tools">UI Element Set Tools</a></li>
                <li><a href="essentials.html#page-popup-navigation">Page / Popup Navigation</a></li>
            </ul>
        </li>
                <li>
            <li><a href="gui-design.html">GUI Design Principles</a></li>
            <!-- ! Submenu -->
        <li>
            <a href="boot-agent.html">Boot Agent</a>
        </li>

        <h2>Plug-ins</h2>
        <li>
            <a>Configuration Files</a>
            <!-- ! Submenu -->
            <ul>
                <li><a href="configuration-files.html#device-config">Device Configuration</a></li>
                <li><a href="configuration-files.html#matrix-config">Matrix Configuration</a></li>
            </ul>
        </li>

        <h2>Sandbox</h2>
        <li><a href="sandbox.html">What is a Sandbox?</a></li>
        <li>
            <a href="defining-a-sandbox.html">Defining a Sandbox</a>
            <!-- ! Submenu -->
        </li>
        <li><a href="sandbox-config.html">Sandbox Config</a></li>

        <h2>Code Examples</h2>
        <li><a href="example-creating-elements.html">Creating Elements</a></li>

    </ul>


    <h3>Quick Search</h3>
    <!-- Search input - event listener attached in JavaScript -->
    <input type="text" id="search" placeholder="Search...">
</aside>

        </div> <!-- ! Sidebar will be inserted here dynamically -->

        <main class="content">
            <h1>Boot Agent</h1>

            <section id="introduction">
                <h2>Introduction to the Boot Agent</h2>
                <p>The Boot Agent (__sp_bootAgent.py) is a critical component of the SP Framework that manages the initialization sequence of the control system. It ensures that all components are loaded and initialized in the correct order, preventing dependency issues and ensuring proper system startup.</p>

                <p>The Boot Agent performs several key functions:</p>
                <ul>
                    <li>Establishes the initial environment for the framework</li>
                    <li>Loads and initializes core framework components</li>
                    <li>Sets up global variables and configuration settings</li>
                    <li>Registers essential services and event handlers</li>
                    <li>Manages the startup sequence to ensure proper dependency resolution</li>
                </ul>
            </section>

            <section id="code-structure">
                <h2>Code Structure Overview</h2>
                <p>The Boot Agent is structured as a Python module with several key components. The module begins with necessary imports and defines global variables that track the boot process. The <code>BOOT_TIMEOUT</code> constant defines how long the system will wait for all components to initialize before timing out.</p>
            </section>

            <section id="initialization-sequence">
                <h2>Initialization Sequence</h2>
                <p>The Boot Agent follows a structured initialization sequence to ensure all components are loaded in the correct order. The <code>initializeFramework()</code> function is the main entry point for the boot process. It sets up a timeout timer and then executes each step of the initialization sequence in order. If any step fails, the exception is caught and handled appropriately.</p>
            </section>

            <section id="component-loading">
                <h2>Component Loading</h2>
                <p>The Boot Agent uses a registration system to track and load components in the correct order. The <code>registerBootComponent()</code> function allows components to register themselves with the Boot Agent, specifying any dependencies they have. The <code>loadCoreComponents()</code> function then resolves these dependencies and loads the components in the correct order.</p>
            </section>

            <section id="dependency-resolution">
                <h2>Dependency Resolution</h2>
                <p>A key feature of the Boot Agent is its ability to resolve dependencies between components. The <code>resolveDependencies()</code> function implements a topological sort algorithm to determine the correct order in which to load components based on their dependencies. It also detects circular dependencies, which would cause the boot process to fail.</p>
            </section>

            <section id="global-initialization">
                <h2>Global Variable Initialization</h2>
                <p>The Boot Agent initializes global variables that will be used throughout the framework. The <code>initializeGlobals()</code> function sets up the global variables that will be used throughout the framework. These include version information, debug settings, and empty containers for various framework objects.</p>
            </section>

            <section id="service-registration">
                <h2>Service Registration</h2>
                <p>The Boot Agent registers essential services that provide functionality to the rest of the framework. The <code>registerServices()</code> function registers various services with the framework, such as logging, error handling, and communication services. Each service is registered with a set of configuration parameters.</p>
            </section>

            <section id="user-configuration">
                <h2>User Configuration Loading</h2>
                <p>The Boot Agent loads user-specific configuration settings. The <code>loadUserConfig()</code> function loads user-specific configuration settings from a configuration file. If the file doesn't exist or there's an error loading it, default values are used instead.</p>
            </section>

            <section id="ui-initialization">
                <h2>UI Initialization</h2>
                <p>The Boot Agent initializes the user interface components. The <code>initializeUI()</code> function initializes the user interface components, including registering touch panels, initializing default pages, and setting up event handlers.</p>
            </section>

            <section id="error-handling">
                <h2>Error Handling</h2>
                <p>The Boot Agent includes robust error handling to manage failures during the boot process. The <code>handleBootFailure()</code> function is called when an error occurs during the boot process. It logs the error, updates the system state, and attempts to recover if possible. If recovery fails, the system enters safe mode using the <code>enterSafeMode()</code> function.</p>
            </section>

            <section id="boot-completion">
                <h2>Boot Completion</h2>
                <p>The Boot Agent includes functions to handle boot completion and timeout. The <code>onBootComplete()</code> function is called when the boot process completes successfully. It records the boot time, logs the completion, and notifies all system components via the <code>notifyBootComplete()</code> function. The <code>bootTimeoutHandler()</code> function is called if the boot process times out, and it handles this as a boot failure.</p>
            </section>

            <section id="main-entry-point">
                <h2>Main Entry Point</h2>
                <p>The Boot Agent includes a main entry point that is called when the module is imported. The <code>main()</code> function is the entry point for the Boot Agent. It prints a startup message and then calls <code>initializeFramework()</code> to start the boot process. The <code>if __name__ == '__main__'</code> block ensures that the main function is called when the module is imported.</p>
            </section>

            <section id="best-practices">
                <h2>Best Practices</h2>
                <p>When working with the Boot Agent, consider the following best practices:</p>

                <ul>
                    <li><strong>Register Dependencies Correctly:</strong> Ensure that all component dependencies are correctly registered to prevent boot failures.</li>
                    <li><strong>Handle Exceptions:</strong> All components should handle exceptions gracefully and report errors to the Boot Agent.</li>
                    <li><strong>Implement onBootComplete:</strong> Components should implement the onBootComplete method to perform any necessary post-boot initialization.</li>
                    <li><strong>Minimize Boot Time:</strong> Keep initialization code efficient to minimize boot time and prevent timeouts.</li>
                    <li><strong>Test Boot Sequence:</strong> Thoroughly test the boot sequence to ensure all components initialize correctly.</li>
                </ul>
            </section>

            <section id="conclusion">
                <h2>Conclusion</h2>
                <p>The Boot Agent is a critical component of the SP Framework that ensures proper initialization of all system components. By managing the boot sequence, resolving dependencies, and handling errors, it provides a solid foundation for the rest of the framework to build upon.</p>

                <p>Understanding how the Boot Agent works is essential for developing robust control systems with the SP Framework. By following the patterns and practices established in the Boot Agent, you can ensure that your control systems start up reliably and handle errors gracefully.</p>
            </section>
        </main>
    </div>
</body>
</html>